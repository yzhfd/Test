{% extends '::base.html.twig' %}

{% block contentTitle %}{{ currentUser.corp is not null ? currentUser.corp.name : '企业' }}杂志用户列表{% endblock %}

{% block main %}

    <div class="content-box"><!-- Start Content Box -->
        <div class="content-box-header">
            <h3>用户列表</h3>
            <div style="padding-top: 6px">
                <a rel="dialog" class="btn info" href="{{ path('staff_user_new') }}">创建杂志用户帐号</a>
            </div>
            <div class="clear"></div>
        </div> <!-- End .content-box-header -->
                
        <div class="content-box-content">
            <div class="tab-content default-tab" id="tab1"> <!-- This is the target div. id must match the href of this div's tab -->
            <table>
                <thead><tr>
                    <th>用户ID</th>
                    <th>用户昵称</th>
                    <th>邮箱</th>
                    <th>注册时间</th>
                    <th>杂志</th>
                    <th>操作</th>
                </tr></thead>
             
                <tfoot><tr>
                    <td colspan="6">
                        {% if pager.haveToPaginate() %}{{ pagerfanta(pager, 'magend') }}{% endif %}
                        <div class="clear"></div>
                    </td>
                </tr></tfoot>
             
                <tbody>
                    {% for user in users %}
                    <tr>
                        <td><a title="查看该用户详情" href="#">{{ user.username }}</a></td>
                        <td><a title="查看该用户详情" href="#">{{ user.nickname }}</a></td>
                        <td>{{ user.email }}</td>
                        <td>{{ user.createdAt|date('Y-m-d H:i') }}</td>
                        <td>
                        {% for mag in user.grantedMags %}
                            <a href="{{ path('magazine_issues', { 'id':mag.id }) }}">{{ mag.name }}</a>{% if not loop.last %}、{% endif %}
                        {% endfor %}
                        </td>
                        <td style="width:100px;">
                            <a rel="dialog" href="{{ path('staff_user_bind', {'id':user.id}) }}" title="关联杂志编辑"><img src="{{ asset('images/book_link.png') }}" alt="关联杂志编辑" /></a>
                            <a rel="dialog" href="{{ path('staff_user_edit', {'id':user.id}) }}" title="编辑"><img src="{{ asset('images/simpla/icons/pencil.png') }}" alt="编辑" /></a>
                            <a rel="confirm" href="{{ path('staff_user_del', {'id':user.id}) }}" title="删除"><img src="{{ asset('images/simpla/icons/cross.png') }}" alt="删除" /></a> 
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            </div>
        </div>
    </div>
                    
{% endblock %}