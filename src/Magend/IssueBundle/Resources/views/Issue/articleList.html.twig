{% extends '::base.html.twig' %}

{% block contentTitle %}世界建筑杂志十二月第一期{% endblock %}

{%block main %}
    <ul class="shortcut-buttons-set">
        <li><a class="shortcut-button" href="{{ path('article_new', { 'id':issue.id }) }}"><span>添加文章</span></a></li>
    </ul>
    <div class="clear"></div>

    <div class="content-box"><!-- Start Content Box -->
        <div class="content-box-header">
            <h3>文章列表</h3>
            <div style="padding-top: 6px; width: 300px; float: left;">
                <a id="layout_save" class="btn info" href="{{ path('issue_layout', { 'id':issue.id }) }}" data-loading-text="保存中...">保存修改</a>
                <!-- <button id="layout_cancel" class="btn danger">放弃修改</button> -->
            </div>
            
            <!-- href must be unique and match the id of target div -->
            <ul class="content-box-tabs">
                <li><a href="#articles_list" class="default-tab">文章列表</a></li>
                <li><a href="#articles_layout">页面排版</a></li>
            </ul>
            <div class="clear"></div>
        </div> <!-- End .content-box-header -->
                
        <div class="content-box-content">
            <div class="tab-content default-tab" id="articles_list"> <!-- This is the target div. id must match the href of this div's tab -->
            <table>
                <thead><tr>
                    <th><input class="check-all" type="checkbox" /></th>
                    <th>名称</th>
                    <th>关键词</th>
                    <th>页数</th>
                    <th>创建时间</th>
                    <th>操作</th>
                </tr></thead>
                
                <tfoot><tr>
                    <td colspan="6">
                        <div class="bulk-actions align-left">
                            <select name="dropdown" class="small">
                                <option value="option1">选择...</option>
                                <!--<option value="option2">编辑</option>-->
                                <option value="option3">删除</option>
                            </select>
                            <a class="button" href="#">执行</a>
                        </div>
                        
                        <div class="clear"></div>
                    </td>
                </tr></tfoot>
                
                <tbody>
                    {% for article in issue.articles %}
                    <tr id="tr{{ article.id }}">
                        <td><input type="checkbox" /></td>
                        <td><a href="{{ path('article_show', { 'id': article.id }) }}">{{ article.title|truncate(10) }}</a></td>
                        <td class="thumbup" style="width:100px;">
                        {% for keyword in article.keywords %}
                        <a href="#">{{ keyword }}</a>{% if not loop.last %}、{% endif %}
                        {% endfor %}
                        </td>
                        <td>{{ article.pageIds|length }}</td>
                        <td>{{ article.createdAt|date('Y-m-d H:i') }}</td>
                        <td>
                            <!-- Icons -->
                             <a href="{{ path('article_edit', { 'id':article.id }) }}" title="编辑">编辑</a>
                             <a rel="confirm" href="#" title="删除">删除</a> 
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            </div>
            
            <div id="articles_layout" class="tab-content" style="min-height: 280px; overflow-x: auto;">
                <ol class="articles unselectable" style="width:{{ issue.articles|length*160 }}px">
                    {% for article in issue.articles %}
                        <li class="article" rel="{{ article.id }}">
                            <h5>=</h5>
                            <ol class="pages">
                                {% for page in article.pages %}
                                    <li class="page" rel="{{ page.id }}"><img src="{{ ('uploads/' ~ page.landscapeImg)|apply_filter('landscapeThumb') }}" /></li>
                                {% endfor %}
                            </ol>
                        </li>
                    {% endfor %}
                </ol>
            </div>
            
        </div>
    </div><!-- End Content Box -->
    
{% endblock %}
